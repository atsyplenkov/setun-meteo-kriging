В данном репозитории собран набор скриптов для интерполяции метеохарактеристик (осадков [Р, мм] и температуры воздуха [Т, °С]) полученных с сайта [pogodaiklimat.ru](https://pogodaiklimat.ru) при помощи пакета [`rp5pik`](https://github.com/atsyplenkov/rp5pik).

В примере рассмотрен период с **мая 2023** года по **январь 2024** года для водосбора р. Сетунь (г. Москва).
## Исходные данные
Всего в районе водосбора р. Сетунь (см. полигон на скриншоте), располагается 12 метеостанций, для которых есть метеорологические данные. Данные с м/с МГУ более доступны, так что она исключена из дальнейшего анализа.

<img src="attachments/Pasted image 20240203114602.png" width="50%" style="display: block; margin: auto;" />

## Процесс получения данных
Процесс парсинга с сайта [pogodaiklimat.ru](https://pogodaiklimat.ru) подробно описан в репозитории пакета [`rp5pik`](https://github.com/atsyplenkov/rp5pik). Здесь за получение и первичную обработку метеоданных отвечает скрипт `workflow/01_download-pik-data.R`. В нем произойдет скачивание данных с сайта для всех нужных метеостанций, их базовая чистка и аггрегация для 9:00 и 21:00 по МСК.

## Подготовка к интерполяции
Процесс интерполяции заключается в том, что в узлы регулярной сетки с шагом в 10 км (файл `data/tidy/grid_tc.Rdata`) для каждого временного шага (т.е. каждые 12 часов) будет произведен Универсальный Кригинг. В качестве предикторов, помимо метеоданных, выступает и среднемноголетняя оценка температуры или осадков по реанализу TerraClimate. Это сделано для того, чтобы повысить точность интерполяции. Так как известно, что для данного региона, реанализ TerraClimate довольно хорошо учитывает пространственную изменчивость метеопараметров. Таким образом, мы можем получить среднемноголетние характеристики как в узлах сетки (куда мы будем интерполировать), так и в локациях метеостанции.

За это отвечает файл `workflow/02_prepare-data-for-interpolation.R`.

## Сама интерполяция
Интерполяция проходит в два этапа: отдельно для осадков и отдельно для температуры. Все описано в файле `03_interpolation.R`. В результате мы получим таблицу, где для каждого временного отрезка есть проинтерполированная средняя температура воздуха и осадки. В примере картинка ниже, показывающая сравнение осадков в **июле 2023 года **на м/с **Немчиновка**, **Внуково** и в центре водосбора р. **Сетунь.**

<img src="attachments/Pasted image 20240203120942.png" width="80%" style="display: block; margin: auto;" />
